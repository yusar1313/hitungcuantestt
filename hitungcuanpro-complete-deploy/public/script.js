document.querySelectorAll('input').forEach(input => {input.setAttribute('inputmode', 'numeric');input.addEventListener('input', calculate);input.addEventListener('paste', handlePaste);});function formatRupiah(value){return new Intl.NumberFormat('id-ID',{style:'currency',currency:'IDR',minimumFractionDigits:0,maximumFractionDigits:0}).format(value);}function handlePaste(e){e.preventDefault();const text=(e.clipboardData||window.clipboardData).getData('text');const numeric=text.replace(/[^\d]/g,'');const value=parseInt(numeric)||0;e.target.value=value;calculate();}function cleanNumber(id){return parseFloat(document.getElementById(id).value.replace(/[^\d\.]/g,''))||0;}function calculate(){const sellingPrice=cleanNumber('sellingPrice');const discount=cleanNumber('discount');const sales=cleanNumber('sales');const productCost=cleanNumber('productCost');const shippingCost=cleanNumber('shippingCost');const otherFees=cleanNumber('otherFees');const adSpend=cleanNumber('adSpend');const returnRate=cleanNumber('returnRate');const effectiveSellingPrice=sellingPrice-discount;const omset=effectiveSellingPrice*sales;const totalCost=productCost+shippingCost+otherFees+(adSpend/(sales||1));const netProfitPerSale=Math.floor(effectiveSellingPrice-totalCost);const grossPotentialProfit=netProfitPerSale*sales;const potentialProfit=Math.floor(grossPotentialProfit*((100-returnRate)/100));const profitMargin=Math.floor((netProfitPerSale/effectiveSellingPrice)*100);const roas=adSpend>0?(omset/adSpend).toFixed(2):'0.00';const cpr=sales>0?Math.floor(adSpend/sales):0;document.getElementById('netProfit').textContent=formatRupiah(netProfitPerSale);document.getElementById('potentialProfit').textContent=formatRupiah(potentialProfit);document.getElementById('profitMargin').textContent=`${profitMargin}%`;document.getElementById('roas').textContent=roas;document.getElementById('cpr').textContent=formatRupiah(cpr);const profitStyle=(el,value)=>{el.style.backgroundColor=value<0?'#dc2626':'#16a34a';el.style.color='#ffffff';const label=el.querySelector('strong');if(label)label.style.color='#000000';};profitStyle(document.getElementById('netProfit').parentElement,netProfitPerSale);profitStyle(document.getElementById('potentialProfit').parentElement,potentialProfit);evaluateAdPerformance(profitMargin,parseFloat(roas),cpr);}function evaluateAdPerformance(profitMargin,roas,cpr){const evalBox=document.getElementById('adEvaluation');let messages=[];if(profitMargin<20){messages.push('âš ï¸ Margin keuntungan rendah. Pertimbangkan menaikkan harga jual atau menekan biaya.');}else if(profitMargin>=30){messages.push('âœ… Margin bagus. Anda punya ruang cukup untuk scale iklan.');}else{messages.push('ğŸ‘Œ Margin cukup. Tetap pantau biaya dan efektivitas iklan.');}if(roas<2){messages.push('âš ï¸ ROAS di bawah standar. Optimalkan targeting atau creative iklan.');}else if(roas>=4){messages.push('âœ… ROAS sangat baik (4+). Waktunya scale iklan Anda!');}else{messages.push('âœ¨ ROAS 2-3 bisa jadi sinyal winning. Pantau lebih lanjut!');}if(cpr>20000){messages.push('âš ï¸ Biaya per hasil (CPR) terlalu tinggi. Coba variasi iklan baru atau perbaiki funnel.');}else if(cpr<=10000){messages.push('âœ… CPR efisien. Pertahankan performa.');}else{messages.push('ğŸ‘Œ CPR wajar. Tetap awasi performa.');}evalBox.innerHTML=messages.map(m=>`<p>${m}</p>`).join('');}calculate();